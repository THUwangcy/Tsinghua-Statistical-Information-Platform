
<script>


    $(".right-column").ready(function () {
        var $this = $(".right-column");

        var questions_params = {
            'questions_type': "default",
            'questions_id': 0
        };


        //刷新中间问卷的最后一个问题
        refreshTable = function (callback) {
            
            loadContentOn($(".last-question"), "{% url 'legalUser/design/question' type act_id%}", questions_params, {anim: false, scroll: false}, callback);
            $(".last-question").removeClass("last-question");
            $(".questions-list").append('<li class="question last-question">\
                                            \
                                         </li>');
        };


        //设置保存和发布按钮点击事件
        $this.find("#save_btn").click(function() {
            $.ajax({
                type: "GET",
                url: "{% url 'api/save_act' %}",
                data: "&act_id=" + "{{act_id}}",
                success: function(data) {
                    if(data['status'] == 'ok') {
                        showConfirmModal("提示", "保存成功！", true);
                    }
                },
                error: function (xhr, textStatus, errorThrown) {
                    alert(xhr.responseText.substr(0, 500));
                }
            });
        })
        $this.find("#publish_btn").click(function() {
            var publish_callback = function() {
                $.ajax({
                    type: "GET",
                    url: "{% url 'api/publish_act' %}",
                    data: "&act_id=" + "{{act_id}}",
                    success: function(data) {
                        params = {
                            'modal_type': 'publish',
                            'id': '{{ act_id }}',
                        }
                        showModal("{% url 'legalUser/modal' %}", 'publish-modal', params);
                    },
                    error: function (xhr, textStatus, errorThrown) {
                        alert(xhr.responseText.substr(0, 500));
                    }
                });
            }

            showConfirmModal("提示", "确定要发布吗？", false, publish_callback);
        })


    })


</script>

{% block css %}

{% endblock css %}


<div class="top-row hidden-xs">
    <a>&nbsp;</a>
    <a class="fake-link pull-right">
        <strong>{{ design_type }}　<i class="fa {{ design_icon }} fa-fw"></i></strong>
    </a>
</div>
<hr class="hidden-xs">

<div class="row">
    <div class="col-md-10">
        {% include 'questionnaire/questionnaire_list.html' %}
    </div>
</div>